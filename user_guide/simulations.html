

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>External simulation tools &mdash; KQCircuits  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/logo.svg"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Creating cross section images" href="xsection.html" />
    <link rel="prev" title="Mask export" href="mask_export.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo-small.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../start/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../start/installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../start/installation.html#klayout">KLayout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../start/installation.html#basic-automatic-installation">Basic automatic installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../start/installation.html#upgrading-salt-package">Upgrading Salt Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../start/installation.html#release-notes">Release Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../start/installation.html#known-installation-issues">Known installation issues</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../start/installation.html#installing-different-python-package-versions-to-klayout-manually">Installing different Python package versions to KLayout manually</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../start/usage.html">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../start/usage.html#modifying-or-creating-elements-or-chips">Modifying or Creating Elements or Chips</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gui_features.html">GUI Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#useful-hotkeys">Useful hotkeys</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#placing-elements">Placing Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#modifying-element-parameters">Modifying Element parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#modifying-waveguides">Modifying waveguides</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#converting-elements-placed-in-gui-into-code">Converting elements placed in GUI into code</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#useful-menu-commands">Useful Menu Commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gui_workflow.html">Point-and-click workflow tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_workflow.html">Python workflow tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python_workflow.html#file-system-hierarchy">File system hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_workflow.html#structure-of-pcell-code">Structure of  PCell code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="python_workflow.html#element-class"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code> class</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_workflow.html#pcell-libraries">PCell Libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_workflow.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_workflow.html#build">Build</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python_workflow.html#example-of-defining-an-element-class">Example of defining an <code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_workflow.html#example-of-defining-a-chip-and-inserting-elements-into-it">Example of defining a Chip and inserting elements into it</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_workflow.html#refpoints">Refpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_workflow.html#faces">Faces</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_workflow.html#opening-element-or-chip-from-an-ide">Opening <code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Chip</span></code> from an IDE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="macro_workflow.html">Macro development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="macro_workflow.html#basic-workflow">Basic workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="macro_workflow.html#debugger">Debugger</a></li>
<li class="toctree-l3"><a class="reference internal" href="macro_workflow.html#reloading-libraries">Reloading libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="macro_workflow.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mask_export.html">Mask export</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mask_export.html#tutorial">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mask_export.html#basic-mask-script-and-export">Basic mask script and export</a></li>
<li class="toctree-l4"><a class="reference internal" href="mask_export.html#ground-grid">Ground grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="mask_export.html#adding-and-modifying-chips">Adding and modifying chips</a></li>
<li class="toctree-l4"><a class="reference internal" href="mask_export.html#multi-face-masks">Multi-face masks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">External simulation tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-simulation-object">Creating simulation object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#geometry-from-klayout-gui">Geometry from Klayout GUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geometry-from-kqcircuits-library">Geometry from KQCircuits library</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ansys-export">Ansys export</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ansys-scripts">Ansys scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sonnet-export">Sonnet export</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gmsh-elmer-export">Gmsh/Elmer export</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="xsection.html">Creating cross section images</a></li>
<li class="toctree-l2"><a class="reference internal" href="terminology.html">Terminology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/setup.html">Developer Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/setup.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/setup.html#python">Python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer/setup.html#sources">Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/setup.html#install">Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/setup.html#update">Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/setup.html#secondary-install">Secondary install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/setup.html#manual-installation">Manual installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/setup.html#linux-or-macos">Linux or MacOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/setup.html#windows">Windows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer/standalone.html">KLayout Standalone Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/standalone.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/standalone.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/standalone.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer/docker_image.html">Docker image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/docker_image.html#cli-usage">CLI usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/docker_image.html#ci-usage">CI usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer/architecture.html">Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/architecture.html#elements">Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/architecture.html#pcell-parameters">PCell parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/architecture.html#libraries">Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/architecture.html#pya-resolver">pya resolver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer/testing.html">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/testing.html#unit-tests">Unit tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer/coding_style.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#versioning">Versioning</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../libraries/index.html">Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../libraries/elements.html">Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#airbridge">Airbridge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#chipframe">ChipFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#element">Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#fingercapacitorsquare">FingerCapacitorSquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#fingercapacitortaper">FingerCapacitorTaper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#flip-chip-connector">Flip chip connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#flip-chip-connector-rf">Flip chip connector Rf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#tsv-connector">TSV connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#manual-squids">Manual SQUIDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#launcher">Launcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#launcherdc">LauncherDC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#marker">Marker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#maskmarkerfc">MaskMarkerFc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#meander">Meander</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#swissmon">Swissmon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#waveguidecoplanar">WaveguideCoplanar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#waveguidecoplanarcurved">WaveguideCoplanarCurved</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#waveguidecoplanarstraight">WaveguideCoplanarStraight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#waveguidecoplanartaper">WaveguideCoplanarTaper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/elements.html#waveguidecoplanartcross">WaveguideCoplanarTCross</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/chips.html">Chips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#airbridgecrossings">AirbridgeCrossings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#airbridgedctest">AirbridgeDcTest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#chip">Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#daisywoven">DaisyWoven</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#demo">Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#empty">Empty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#junctiontest">JunctionTest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#junctiontest2">JunctionTest2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#lithographytest">LithographyTest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#crossingtwoface">CrossingTwoface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#qualityfactortwoface">QualityFactorTwoface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#qualityfactor">QualityFactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#shaping">Shaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#singlexmons">SingleXmons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#stripes">Stripes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/chips.html#xmonsdirectcoupling">XmonsDirectCoupling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/test_structures.html">Test structures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../libraries/test_structures.html#airbridgedc">AirbridgeDC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/test_structures.html#junctiontestpads">JunctionTestPads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/test_structures.html#tsvtestpattern">TsvTestPattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../libraries/test_structures.html#stripestest">StripesTest</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/kqcircuits.html">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.chips.html">kqcircuits.chips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.airbridge_crossings.html">kqcircuits.chips.airbridge_crossings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.airbridge_dc_test.html">kqcircuits.chips.airbridge_dc_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.chip.html">kqcircuits.chips.chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.crossing_twoface.html">kqcircuits.chips.crossing_twoface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.daisy_woven.html">kqcircuits.chips.daisy_woven</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.dc_test.html">kqcircuits.chips.dc_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.demo.html">kqcircuits.chips.demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.demo_twoface.html">kqcircuits.chips.demo_twoface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.empty.html">kqcircuits.chips.empty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.junction_test.html">kqcircuits.chips.junction_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.junction_test2.html">kqcircuits.chips.junction_test2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.launchers.html">kqcircuits.chips.launchers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.lithography_test.html">kqcircuits.chips.lithography_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.lithography_test_twoface.html">kqcircuits.chips.lithography_test_twoface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.quality_factor.html">kqcircuits.chips.quality_factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.quality_factor_twoface.html">kqcircuits.chips.quality_factor_twoface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.sample_holder_test.html">kqcircuits.chips.sample_holder_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.shaping.html">kqcircuits.chips.shaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.simple.html">kqcircuits.chips.simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.single_xmons.html">kqcircuits.chips.single_xmons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.stripes.html">kqcircuits.chips.stripes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.tsv_test.html">kqcircuits.chips.tsv_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.xmons_direct_coupling.html">kqcircuits.chips.xmons_direct_coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.chips.html#module-kqcircuits.chips">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.elements.html">kqcircuits.elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.airbridges.html">kqcircuits.elements.airbridges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.airbridges.airbridge.html">kqcircuits.elements.airbridges.airbridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.airbridges.airbridge_multi_face.html">kqcircuits.elements.airbridges.airbridge_multi_face</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.airbridges.airbridge_rectangular.html">kqcircuits.elements.airbridges.airbridge_rectangular</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.airbridges.html#module-kqcircuits.elements.airbridges">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.f2f_connectors.html">kqcircuits.elements.f2f_connectors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.f2f_connectors.flip_chip_connectors.html">kqcircuits.elements.f2f_connectors.flip_chip_connectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.f2f_connectors.tsvs.html">kqcircuits.elements.f2f_connectors.tsvs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.f2f_connectors.html#module-kqcircuits.elements.f2f_connectors">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.fluxlines.html">kqcircuits.elements.fluxlines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.fluxlines.fluxline.html">kqcircuits.elements.fluxlines.fluxline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.fluxlines.fluxline_standard.html">kqcircuits.elements.fluxlines.fluxline_standard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.fluxlines.fluxline_straight.html">kqcircuits.elements.fluxlines.fluxline_straight</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.fluxlines.html#module-kqcircuits.elements.fluxlines">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.markers.html">kqcircuits.elements.markers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.markers.marker.html">kqcircuits.elements.markers.marker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.markers.marker_standard.html">kqcircuits.elements.markers.marker_standard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.elements.markers.html#module-kqcircuits.elements.markers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.airbridge_connection.html">kqcircuits.elements.airbridge_connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.chip_frame.html">kqcircuits.elements.chip_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.circular_capacitor.html">kqcircuits.elements.circular_capacitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.element.html">kqcircuits.elements.element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.finger_capacitor_square.html">kqcircuits.elements.finger_capacitor_square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.finger_capacitor_taper.html">kqcircuits.elements.finger_capacitor_taper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.launcher.html">kqcircuits.elements.launcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.launcher_dc.html">kqcircuits.elements.launcher_dc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.mask_marker_fc.html">kqcircuits.elements.mask_marker_fc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.meander.html">kqcircuits.elements.meander</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.smooth_capacitor.html">kqcircuits.elements.smooth_capacitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.spiral_resonator_polygon.html">kqcircuits.elements.spiral_resonator_polygon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.waveguide_composite.html">kqcircuits.elements.waveguide_composite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.waveguide_coplanar.html">kqcircuits.elements.waveguide_coplanar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.waveguide_coplanar_curved.html">kqcircuits.elements.waveguide_coplanar_curved</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.waveguide_coplanar_splitter.html">kqcircuits.elements.waveguide_coplanar_splitter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.waveguide_coplanar_straight.html">kqcircuits.elements.waveguide_coplanar_straight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.waveguide_coplanar_taper.html">kqcircuits.elements.waveguide_coplanar_taper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.waveguide_coplanar_tcross.html">kqcircuits.elements.waveguide_coplanar_tcross</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.elements.html#module-kqcircuits.elements">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.masks.html">kqcircuits.masks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.masks.mask_export.html">kqcircuits.masks.mask_export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.masks.mask_layout.html">kqcircuits.masks.mask_layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.masks.mask_set.html">kqcircuits.masks.mask_set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.masks.html#module-kqcircuits.masks">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.qubits.html">kqcircuits.qubits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.qubits.qubit.html">kqcircuits.qubits.qubit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.qubits.swissmon.html">kqcircuits.qubits.swissmon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.qubits.html#module-kqcircuits.qubits">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.simulations.html">kqcircuits.simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.export.html">kqcircuits.simulations.export</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.simulations.export.ansys.html">kqcircuits.simulations.export.ansys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.simulations.export.elmer.html">kqcircuits.simulations.export.elmer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.simulations.export.sonnet.html">kqcircuits.simulations.export.sonnet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.simulations.export.simulation_export.html">kqcircuits.simulations.export.simulation_export</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/kqcircuits.simulations.export.util.html">kqcircuits.simulations.export.util</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.airbridges_sim.html">kqcircuits.simulations.airbridges_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.circular_capacitor_sim.html">kqcircuits.simulations.circular_capacitor_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.empty_simulation.html">kqcircuits.simulations.empty_simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.finger_capacitor_sim.html">kqcircuits.simulations.finger_capacitor_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.flip_chip_connector_sim.html">kqcircuits.simulations.flip_chip_connector_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.port.html">kqcircuits.simulations.port</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.simulation.html">kqcircuits.simulations.simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.single_xmons_full_chip_sim.html">kqcircuits.simulations.single_xmons_full_chip_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.waveguides_sim.html">kqcircuits.simulations.waveguides_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.xmons_direct_coupling_full_chip_sim.html">kqcircuits.simulations.xmons_direct_coupling_full_chip_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.xmons_direct_coupling_sim.html">kqcircuits.simulations.xmons_direct_coupling_sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.simulations.html#module-kqcircuits.simulations">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.squids.html">kqcircuits.squids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.squids.manhattan.html">kqcircuits.squids.manhattan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.squids.sim.html">kqcircuits.squids.sim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.squids.squid.html">kqcircuits.squids.squid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.squids.html#module-kqcircuits.squids">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.test_structures.html">kqcircuits.test_structures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.airbridge_dc.html">kqcircuits.test_structures.airbridge_dc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.cross_test.html">kqcircuits.test_structures.cross_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.junction_test_pads.html">kqcircuits.test_structures.junction_test_pads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.junction_test_pads_simple.html">kqcircuits.test_structures.junction_test_pads_simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.stripes_test.html">kqcircuits.test_structures.stripes_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.test_structure.html">kqcircuits.test_structures.test_structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.tsv_test_pattern.html">kqcircuits.test_structures.tsv_test_pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.test_structures.html#module-kqcircuits.test_structures">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.util.html">kqcircuits.util</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.area.html">kqcircuits.util.area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.count_instances.html">kqcircuits.util.count_instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.coupler_lib.html">kqcircuits.util.coupler_lib</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.deep_delete.html">kqcircuits.util.deep_delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.dependencies.html">kqcircuits.util.dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.export_helper.html">kqcircuits.util.export_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.geometry_helper.html">kqcircuits.util.geometry_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.geometry_json_encoder.html">kqcircuits.util.geometry_json_encoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.groundgrid.html">kqcircuits.util.groundgrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.label.html">kqcircuits.util.label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.layout_to_code.html">kqcircuits.util.layout_to_code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.library_helper.html">kqcircuits.util.library_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.log_router.html">kqcircuits.util.log_router</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.macro_prepare.html">kqcircuits.util.macro_prepare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.merge.html">kqcircuits.util.merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.netlist_extraction.html">kqcircuits.util.netlist_extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.netlist_graph.html">kqcircuits.util.netlist_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.parameter_helper.html">kqcircuits.util.parameter_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.parameters.html">kqcircuits.util.parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.refpoints.html">kqcircuits.util.refpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.replace_squids.html">kqcircuits.util.replace_squids</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.symmetric_polygons.html">kqcircuits.util.symmetric_polygons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/kqcircuits.util.html#module-kqcircuits.util">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.defaults.html">kqcircuits.defaults</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.klayout_view.html">kqcircuits.klayout_view</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.layer_cluster.html">kqcircuits.layer_cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.pya_resolver.html">kqcircuits.pya_resolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/kqcircuits.html#module-kqcircuits">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trademarks.html">Trademarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#contributors">Contributors</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">KQCircuits</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">User Guide</a> &raquo;</li>
        
      <li>External simulation tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/iqm-finland/KQCircuits/blob/main/docs/user_guide/simulations.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="external-simulation-tools">
<h1>External simulation tools<a class="headerlink" href="#external-simulation-tools" title="Permalink to this headline">¶</a></h1>
<p>KQCircuits supports exports to following external simulation tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ansys.com/products/electronics/ansys-hfss">Ansys HFSS</a> and <a class="reference external" href="https://www.ansys.com/products/electronics/ansys-q3d-extractor">Q3D Extractor</a></p></li>
<li><p><a class="reference external" href="https://www.sonnetsoftware.com">Sonnet</a></p></li>
<li><p><a class="reference external" href="https://gmsh.info">Gmsh</a> and <a class="reference external" href="http://www.elmerfem.org">Elmer</a></p></li>
</ul>
<div class="section" id="creating-simulation-object">
<h2>Creating simulation object<a class="headerlink" href="#creating-simulation-object" title="Permalink to this headline">¶</a></h2>
<p>Simulation export begins by creating an instance of <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> class. The simulation object includes following information:</p>
<ul class="simple">
<li><p>name (defines export filenames)</p></li>
<li><p>geometry for the simulation</p></li>
<li><p>port locations and types</p></li>
</ul>
<div class="section" id="geometry-from-klayout-gui">
<h3>Geometry from Klayout GUI<a class="headerlink" href="#geometry-from-klayout-gui" title="Permalink to this headline">¶</a></h3>
<p>When you have an active project open, import the following and get the top cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kqcircuits.klayout_view</span> <span class="kn">import</span> <span class="n">KLayoutView</span>
<span class="kn">from</span> <span class="nn">kqcircuits.simulations.simulation</span> <span class="kn">import</span> <span class="n">Simulation</span>

<span class="n">top_cell</span> <span class="o">=</span> <span class="n">KLayoutView</span><span class="o">.</span><span class="n">get_active_cell</span><span class="p">()</span>
</pre></div>
</div>
<p>Create an instance of <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">from_cell</span><span class="p">(</span><span class="n">top_cell</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dev&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">simulation</span></code> object is needed for Ansys export and Sonnet export (more details in following sections). Alternatively, run following macros in Klayout:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/macros/export/export_ansys.lym">scripts/macros/export/export_ansys.lym</a></p></li>
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/macros/export/export_sonnet.lym">scripts/macros/export/export_sonnet.lym</a></p></li>
</ul>
</div>
<div class="section" id="geometry-from-kqcircuits-library">
<h3>Geometry from KQCircuits library<a class="headerlink" href="#geometry-from-kqcircuits-library" title="Permalink to this headline">¶</a></h3>
<p>Define the geometry and ports in KQCircuits by inheriting <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> class. Following creates waveguide crossing the domain box:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kqcircuits.simulations.simulation</span> <span class="kn">import</span> <span class="n">Simulation</span>
<span class="kn">from</span> <span class="nn">kqcircuits.pya_resolver</span> <span class="kn">import</span> <span class="n">pya</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">kqcircuits.util.export_helper</span> <span class="kn">import</span> <span class="n">get_active_or_new_layout</span>

<span class="k">class</span> <span class="nc">WaveguideSimulation</span><span class="p">(</span><span class="n">Simulation</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">produce_waveguide_to_port</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">DPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">center</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
                                       <span class="n">pya</span><span class="o">.</span><span class="n">DPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">center</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
                                       <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">use_internal_ports</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Get layout for <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">get_active_or_new_layout</span><span class="p">()</span>
</pre></div>
</div>
<p>Create an instance of <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span> <span class="o">=</span> <span class="n">WaveguideSimulation</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dev&#39;</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">pya</span><span class="o">.</span><span class="n">DBox</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">DPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">pya</span><span class="o">.</span><span class="n">DPoint</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Simulation</span></code> class and it’s subclasses are located in folder <a class="reference external" href="https://github.com/iqm-finland/KQCircuits/tree/main/klayout_package/python/kqcircuits/simulations">kqcircuits/simulations/</a>.</p>
</div>
</div>
<div class="section" id="ansys-export">
<h2>Ansys export<a class="headerlink" href="#ansys-export" title="Permalink to this headline">¶</a></h2>
<p>Once the <code class="docutils literal notranslate"><span class="pre">simulation</span></code> object is created, call function <code class="docutils literal notranslate"><span class="pre">export_ansys_json</span></code> to export the geometry as GDSII file and meta-data in json format. Parameter <code class="docutils literal notranslate"><span class="pre">ansys_tool</span></code> determines whether to use HFSS (‘hfss’) or Q3D Extractor (‘q3d’):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kqcircuits.simulations.export.ansys.ansys_export</span> <span class="kn">import</span> <span class="n">export_ansys_json</span><span class="p">,</span> <span class="n">copy_ansys_scripts_to_directory</span><span class="p">,</span> <span class="n">export_ansys_bat</span><span class="p">,</span> <span class="n">export_ansys</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Your</span><span class="se">\\</span><span class="s2">Path</span><span class="se">\\</span><span class="s2">Here</span><span class="se">\\</span><span class="s2">&quot;</span>
<span class="n">json</span> <span class="o">=</span> <span class="n">export_ansys_json</span><span class="p">(</span><span class="n">simulation</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">ansys_tool</span><span class="o">=</span><span class="s1">&#39;hfss&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Performing simulations requires Ansys-scripts, which are located at <a class="reference external" href="https://github.com/iqm-finland/KQCircuits/tree/main/klayout_package/python/scripts/simulations/ansys">scripts/simulations/ansys/</a>. Usually, it’s convenient to copy this folder to the export path by calling <code class="docutils literal notranslate"><span class="pre">copy_ansys_scripts_to_directory</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">copy_ansys_scripts_to_directory</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>You can create a Windows batch file for running multiple simulations in a row by calling function <code class="docutils literal notranslate"><span class="pre">export_ansys_bat</span></code>. The first argument is a list of exported json filenames:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bat</span> <span class="o">=</span> <span class="n">export_ansys_bat</span><span class="p">([</span><span class="n">json</span><span class="p">],</span> <span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, you can call <code class="docutils literal notranslate"><span class="pre">export_ansys</span></code> to cover last three steps. This exports multiple simulations that are stored in a list, copies the Ansys-scripts into the folder, and creates the Windows batch file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bat</span> <span class="o">=</span> <span class="n">export_ansys</span><span class="p">([</span><span class="n">simulation</span><span class="p">],</span> <span class="n">path</span><span class="p">,</span> <span class="n">ansys_tool</span><span class="o">=</span><span class="s1">&#39;hfss&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="ansys-scripts">
<h3>Ansys scripts<a class="headerlink" href="#ansys-scripts" title="Permalink to this headline">¶</a></h3>
<p>The folder <a class="reference external" href="https://github.com/iqm-finland/KQCircuits/tree/main/klayout_package/python/scripts/simulations/ansys">scripts/simulations/ansys/</a> contains several IronPython scripts to run simulations in Ansys Electronics Desktop. Scripts support HFSS and Q3D Extractor frameworks.</p>
<p>The scripts are developed and tested with Ansys Electronic Desktop 2021 R1 on Windows x64.</p>
<p>The primary use case is to estimate capacitive couplings between different elements in the layout, where each element
of interest has a port in the simulation. The capacitances are represented as a matrix, where the <em>Cij</em> is the
capacitance between two ports <em>i</em> and <em>j</em>, and <em>Cii</em> is the capacitance between port <em>i</em> and ground.</p>
<div class="section" id="main-scripts">
<h4>Main scripts:<a class="headerlink" href="#main-scripts" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/simulations/ansys/import_simulation_geometry.py">import_simulation_geometry.py</a></p>
<p>Argument: path to json file exported by <code class="docutils literal notranslate"><span class="pre">export_ansys_json</span></code>.</p>
<p>Creates a new project, imports the geometry, defines ports/nets and materials, and sets up the analysis setup.</p>
</li>
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/simulations/ansys/create_capacitive_pi_model.py">create_capacitive_pi_model.py</a></p>
<p>No argument.</p>
<p>Adds solution variables and reports for a PI model between all ports/nets in the current design.</p>
<p>The variables <code class="docutils literal notranslate"><span class="pre">yy_i_j</span></code> give the scalar admittance between port <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code>, or the admittance from port <code class="docutils literal notranslate"><span class="pre">i</span></code> to
ground if <code class="docutils literal notranslate"><span class="pre">i==j</span></code>. The <code class="docutils literal notranslate"><span class="pre">yy</span></code>-variables are created only in HFSS.</p>
<p>Similarly, the variables <code class="docutils literal notranslate"><span class="pre">C_i_j</span></code> give the capacitance between ports and from ports to ground,
assuming a purely capacitive model. This assumption is valid as long as the resulting <code class="docutils literal notranslate"><span class="pre">C_i_j</span></code> are constant over frequency.</p>
</li>
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/simulations/ansys/export_solution_data.py">export_solution_data.py</a></p>
<p>No argument.</p>
<p>Exports data from the solutions. <em>projectname_CMatrix.txt</em> contains the elements <code class="docutils literal notranslate"><span class="pre">C_i_j</span></code> in fF (at 1 GHz in HFSS).
<em>projectname_results.json</em> contains all <code class="docutils literal notranslate"><span class="pre">C_i_j</span></code> and <code class="docutils literal notranslate"><span class="pre">yy_i_j</span></code> elements for all frequencies in the solution.
In case of HFSS, <em>projectname_SMatrix.s2p</em> contains the S-parameters.</p>
</li>
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/simulations/ansys/import_and_simulate.py">import_and_simulate.py</a></p>
<p>Argument: path to json file exported by <code class="docutils literal notranslate"><span class="pre">export_ansys_json</span></code>.</p>
<p>Performs the full simulation sequence including running the three other scripts, saving the project, and running the simulation.</p>
</li>
</ul>
<p>Additional scripts for use cases other than capacitive coupling exist.
These are enabled in <a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/simulations/ansys/import_and_simulate.py">import_and_simulate.py</a> with a list of strings as parameters to <code class="docutils literal notranslate"><span class="pre">export_ansys</span></code>,
e.g., to enable exporting Time Domain Reflectometry (TDR) and non-de-embedded Touchstone (<code class="docutils literal notranslate"><span class="pre">.sNp</span></code>) files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export_ansys</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">export_processing</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tdr&#39;</span><span class="p">,</span> <span class="s1">&#39;snp_no_deembed&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The optional scripts are listed below.</p>
</div>
<div class="section" id="optional-scripts">
<h4>Optional scripts:<a class="headerlink" href="#optional-scripts" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/simulations/ansys/export_snp_no_deembed.py">export_snp_no_deembed.py</a></p>
<p>No argument.</p>
<p>Disables de-embedding and exports the <span class="math notranslate nohighlight">\(S\)</span>-matrix network data to a Touchstone (<code class="docutils literal notranslate"><span class="pre">.sNp</span></code>) file.</p>
<p>Works only in HFSS.</p>
</li>
<li><p><a class="reference external" href="https://github.com/iqm-finland/KQCircuits/blob/main/klayout_package/python/scripts/simulations/ansys/export_tdr.py">export_tdr.py</a></p>
<p>No argument.</p>
<p>Creates a Time Domain Reflectometry report using <code class="docutils literal notranslate"><span class="pre">TDRZt(port)</span></code> for all ports and exports the data to a <code class="docutils literal notranslate"><span class="pre">.csv</span></code>.</p>
<p>Works only in HFSS.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="sonnet-export">
<h2>Sonnet export<a class="headerlink" href="#sonnet-export" title="Permalink to this headline">¶</a></h2>
<p>Once the <code class="docutils literal notranslate"><span class="pre">simulation</span></code> object is created, call function <code class="docutils literal notranslate"><span class="pre">export_sonnet_son</span></code> to export simulation into <code class="docutils literal notranslate"><span class="pre">.son</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kqcircuits.simulations.export.sonnet.sonnet_export</span> <span class="kn">import</span> <span class="n">export_sonnet_son</span><span class="p">,</span> <span class="n">export_sonnet</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Your</span><span class="se">\\</span><span class="s2">Path</span><span class="se">\\</span><span class="s2">Here</span><span class="se">\\</span><span class="s2">&quot;</span>
<span class="n">son</span> <span class="o">=</span> <span class="n">export_sonnet_son</span><span class="p">(</span><span class="n">simulation</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple simulations can be exported by calling <code class="docutils literal notranslate"><span class="pre">export_sonnet</span></code>. The function takes list of simulations as it’s first parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sons</span> <span class="o">=</span> <span class="n">export_sonnet</span><span class="p">([</span><span class="n">simulation</span><span class="p">],</span> <span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="gmsh-elmer-export">
<h2>Gmsh/Elmer export<a class="headerlink" href="#gmsh-elmer-export" title="Permalink to this headline">¶</a></h2>
<p>Usage of Gmsh and Elmer export is similar to Ansys export.
The <code class="docutils literal notranslate"><span class="pre">simulation</span></code> object can be used with function <code class="docutils literal notranslate"><span class="pre">export_elmer</span></code> to export all necessary files to produce Gmsh/Elmer
simulations.</p>
<p>There is an example at ‘klayout_package/python/scripts/simulations/waveguides_sim_compare.py’, which creates a simulation folder
with simulation scripts. The folder is created to <cite>$TMP</cite> (usually <cite>kqcircuits/tmp</cite>). The contents of the folder is something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>waveguides_sim_elmer
├── COMMIT_REFERENCE
├── scripts
│   ├── elmer_helpers.py
│   ├── gmsh_helpers.py
│   └── run.py
├── sif
│   ├── CapacitanceMatrix.sif
│   └── electric_potential.pvsm
├── simulation.oas
├── simulation.sh
├── waveguides_n_guides_1.gds
├── waveguides_n_guides_1.json
├── waveguides_n_guides_1.sh
├── waveguides_n_guides_2.gds
├── waveguides_n_guides_2.json
└── waveguides_n_guides_2.sh
</pre></div>
</div>
<p><cite>script</cite> folder contains scripts that are used for preparing the simulations.</p>
<p><cite>sif</cite> contains the Solver Input Files (SIF) for Elmer (scripts in <cite>scripts</cite> -folder are used
to build the SIF files for each simulation).</p>
<p><cite>waveguides_n_guides_1.sh</cite>, <cite>waveguides_n_guides_2.sh</cite>, <cite>…</cite> are the shell scripts for running each simulation.
Each script executes Gmsh (mesh creation), computes the FEM model using Elmer (computes the
capacitance matrix), and visualizes the results using Paraview.</p>
<p><cite>simulation.sh</cite> is a shell script for running all simulations at once.
The simulations are executed by running the <cite>.sh</cite> file in the output folder (here <cite>waveguides_sim_elmer</cite>).</p>
<p>Please note that running the example requires the installation of</p>
<ul class="simple">
<li><p>gmsh python api
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">gmsh</span></code></p></li>
<li><p>Elmerfem solver
see <a class="reference external" href="https://github.com/ElmerCSC/elmerfem">https://github.com/ElmerCSC/elmerfem</a></p></li>
<li><p>Paraview
<a class="reference external" href="https://www.paraview.org/">https://www.paraview.org/</a></p></li>
</ul>
<p>Gmsh api suffices if one needs to generate the mesh only.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="xsection.html" class="btn btn-neutral float-right" title="Creating cross section images" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mask_export.html" class="btn btn-neutral float-left" title="Mask export" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021-2022, IQM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>